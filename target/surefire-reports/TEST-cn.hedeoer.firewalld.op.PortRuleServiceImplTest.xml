<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="16.418" tests="10" errors="0" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="java.specification.version" value="11"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/hedeoer/IdeaProjects/agent/target/test-classes:/home/hedeoer/IdeaProjects/agent/target/classes:/home/hedeoer/.m2/repository/redis/clients/jedis/5.2.0/jedis-5.2.0.jar:/home/hedeoer/.m2/repository/org/apache/commons/commons-pool2/2.12.0/commons-pool2-2.12.0.jar:/home/hedeoer/.m2/repository/org/json/json/20240303/json-20240303.jar:/home/hedeoer/.m2/repository/com/google/code/gson/gson/2.11.0/gson-2.11.0.jar:/home/hedeoer/.m2/repository/com/google/errorprone/error_prone_annotations/2.27.0/error_prone_annotations-2.27.0.jar:/home/hedeoer/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.17.2/jackson-databind-2.17.2.jar:/home/hedeoer/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.17.2/jackson-annotations-2.17.2.jar:/home/hedeoer/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.17.2/jackson-core-2.17.2.jar:/home/hedeoer/.m2/repository/org/zeroturnaround/zt-exec/1.12/zt-exec-1.12.jar:/home/hedeoer/.m2/repository/com/jcraft/jsch/0.1.55/jsch-0.1.55.jar:/home/hedeoer/.m2/repository/com/github/hypfvieh/dbus-java-core/4.3.2/dbus-java-core-4.3.2.jar:/home/hedeoer/.m2/repository/com/github/hypfvieh/dbus-java-transport-junixsocket/4.3.2/dbus-java-transport-junixsocket-4.3.2.jar:/home/hedeoer/.m2/repository/com/kohlschutter/junixsocket/junixsocket-native-common/2.8.3/junixsocket-native-common-2.8.3.jar:/home/hedeoer/.m2/repository/com/kohlschutter/junixsocket/junixsocket-common/2.8.3/junixsocket-common-2.8.3.jar:/home/hedeoer/.m2/repository/com/kohlschutter/compiler-annotations/1.5.6/compiler-annotations-1.5.6.jar:/home/hedeoer/.m2/repository/org/eclipse/jdt/org.eclipse.jdt.annotation/2.2.700/org.eclipse.jdt.annotation-2.2.700.jar:/home/hedeoer/.m2/repository/org/projectlombok/lombok/1.18.38/lombok-1.18.38.jar:/home/hedeoer/.m2/repository/com/github/oshi/oshi-core/6.8.0/oshi-core-6.8.0.jar:/home/hedeoer/.m2/repository/net/java/dev/jna/jna/5.17.0/jna-5.17.0.jar:/home/hedeoer/.m2/repository/net/java/dev/jna/jna-platform/5.17.0/jna-platform-5.17.0.jar:/home/hedeoer/.m2/repository/org/slf4j/slf4j-api/2.0.17/slf4j-api-2.0.17.jar:/home/hedeoer/.m2/repository/ch/qos/logback/logback-classic/1.3.14/logback-classic-1.3.14.jar:/home/hedeoer/.m2/repository/ch/qos/logback/logback-core/1.3.14/logback-core-1.3.14.jar:/home/hedeoer/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/hedeoer/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:"/>
    <property name="java.vm.vendor" value="Oracle Corporation"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="http://java.oracle.com/"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="11"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="user.country" value="US"/>
    <property name="sun.boot.library.path" value="/home/hedeoer/software/jdk-11/lib"/>
    <property name="sun.java.command" value="/home/hedeoer/IdeaProjects/agent/target/surefire/surefirebooter-20250422233113658_3.jar /home/hedeoer/IdeaProjects/agent/target/surefire 2025-04-22T23-31-13_188-jvmRun1 surefire-20250422233113658_1tmp surefire_0-20250422233113658_2tmp"/>
    <property name="jdk.debug" value="release"/>
    <property name="surefire.test.class.path" value="/home/hedeoer/IdeaProjects/agent/target/test-classes:/home/hedeoer/IdeaProjects/agent/target/classes:/home/hedeoer/.m2/repository/redis/clients/jedis/5.2.0/jedis-5.2.0.jar:/home/hedeoer/.m2/repository/org/apache/commons/commons-pool2/2.12.0/commons-pool2-2.12.0.jar:/home/hedeoer/.m2/repository/org/json/json/20240303/json-20240303.jar:/home/hedeoer/.m2/repository/com/google/code/gson/gson/2.11.0/gson-2.11.0.jar:/home/hedeoer/.m2/repository/com/google/errorprone/error_prone_annotations/2.27.0/error_prone_annotations-2.27.0.jar:/home/hedeoer/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.17.2/jackson-databind-2.17.2.jar:/home/hedeoer/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.17.2/jackson-annotations-2.17.2.jar:/home/hedeoer/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.17.2/jackson-core-2.17.2.jar:/home/hedeoer/.m2/repository/org/zeroturnaround/zt-exec/1.12/zt-exec-1.12.jar:/home/hedeoer/.m2/repository/com/jcraft/jsch/0.1.55/jsch-0.1.55.jar:/home/hedeoer/.m2/repository/com/github/hypfvieh/dbus-java-core/4.3.2/dbus-java-core-4.3.2.jar:/home/hedeoer/.m2/repository/com/github/hypfvieh/dbus-java-transport-junixsocket/4.3.2/dbus-java-transport-junixsocket-4.3.2.jar:/home/hedeoer/.m2/repository/com/kohlschutter/junixsocket/junixsocket-native-common/2.8.3/junixsocket-native-common-2.8.3.jar:/home/hedeoer/.m2/repository/com/kohlschutter/junixsocket/junixsocket-common/2.8.3/junixsocket-common-2.8.3.jar:/home/hedeoer/.m2/repository/com/kohlschutter/compiler-annotations/1.5.6/compiler-annotations-1.5.6.jar:/home/hedeoer/.m2/repository/org/eclipse/jdt/org.eclipse.jdt.annotation/2.2.700/org.eclipse.jdt.annotation-2.2.700.jar:/home/hedeoer/.m2/repository/org/projectlombok/lombok/1.18.38/lombok-1.18.38.jar:/home/hedeoer/.m2/repository/com/github/oshi/oshi-core/6.8.0/oshi-core-6.8.0.jar:/home/hedeoer/.m2/repository/net/java/dev/jna/jna/5.17.0/jna-5.17.0.jar:/home/hedeoer/.m2/repository/net/java/dev/jna/jna-platform/5.17.0/jna-platform-5.17.0.jar:/home/hedeoer/.m2/repository/org/slf4j/slf4j-api/2.0.17/slf4j-api-2.0.17.jar:/home/hedeoer/.m2/repository/ch/qos/logback/logback-classic/1.3.14/logback-classic-1.3.14.jar:/home/hedeoer/.m2/repository/ch/qos/logback/logback-core/1.3.14/logback-core-1.3.14.jar:/home/hedeoer/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/hedeoer/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/hedeoer"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.version.date" value="2018-09-25"/>
    <property name="java.home" value="/home/hedeoer/software/jdk-11"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/hedeoer/IdeaProjects/agent"/>
    <property name="java.vm.compressedOopsMode" value="Zero based"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/hedeoer/IdeaProjects/agent/target/surefire/surefirebooter-20250422233113658_3.jar"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="11+28"/>
    <property name="user.name" value="hedeoer"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="3.10.0-1160.el7.x86_64"/>
    <property name="java.runtime.name" value="Java(TM) SE Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="Java HotSpot(TM) 64-Bit Server VM"/>
    <property name="java.vendor.version" value="18.9"/>
    <property name="localRepository" value="/home/hedeoer/.m2/repository"/>
    <property name="java.vendor.url.bug" value="http://bugreport.java.com/bugreport/"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="idea.version" value="2025.1"/>
    <property name="java.version" value="11"/>
    <property name="user.dir" value="/home/hedeoer/IdeaProjects/agent"/>
    <property name="os.arch" value="amd64"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vendor" value="Oracle Corporation"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vm.version" value="11+28"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="55.0"/>
  </properties>
  <testcase name="addOrRemoveBatchPortRules" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="1.623">
    <system-out><![CDATA[2025-04-22 23:31:14.124 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="172.16.0.0/24" port port="30001" protocol="tcp" accept' --permanent ; firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="172.16.10.11" port port="30001" protocol="tcp" accept' --permanent
2025-04-22 23:31:14.741 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="192.168.1.20" port port="30001" protocol="tcp" accept' --permanent
2025-04-22 23:31:14.884 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="10.0.0.0/8" port port="5555" protocol="tcp" accept' --permanent
2025-04-22 23:31:15.032 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="10.0.0.0/8" port port="5555" protocol="udp" accept' --permanent
true
]]></system-out>
  </testcase>
  <testcase name="updateOnePortRule" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="1.648">
    <system-out><![CDATA[2025-04-22 23:31:15.571 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="172.16.0.0/24" port port="30001" protocol="tcp" accept' --permanent ; firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="172.16.10.11" port port="30001" protocol="tcp" accept' --permanent
2025-04-22 23:31:16.341 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="172.16.0.0/24" port port="30001" protocol="tcp" accept' --permanent ; firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="172.16.10.11" port port="30001" protocol="tcp" accept' --permanent
2025-04-22 23:31:16.680 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="172.16.0.0/24" port port="30001" protocol="udp" accept' --permanent ; firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="172.16.10.11" port port="30001" protocol="udp" accept' --permanent
update ： true
]]></system-out>
  </testcase>
  <testcase name="queryPortRulesByUsingStatus" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="3.675">
    <system-out><![CDATA[2025-04-22 23:31:17.225 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.f.op.FirewallPolicyConfigurer&amp#27;[0;39m - 当前用户: hedeoer
2025-04-22 23:31:17.531 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mo.f.d.c.transports.TransportBuilder&amp#27;[0;39m - Using transport dbus-java-transport-junixsocket for address unix:path=/var/run/dbus/system_bus_socket
2025-04-22 23:31:17.677 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从富规则中提取的端口规则有portRulesFromRichRules 3 条 :
2025-04-22 23:31:17.677 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从dbus端口查询中提取的端口规则有portRulesFromDbusPortQuery 4 条 :
2025-04-22 23:31:20.888 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,按照（端口号，端口协议）去重，优先富规则形式，合并端口规则后有 6 条 :
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='5953', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='8080', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.22), policy=true, using=false, protocol='tcp', port='30001', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.11), policy=true, using=false, protocol='udp', port='30001', family='ipv4'}
]]></system-out>
  </testcase>
  <testcase name="testAddOrRemovePortRuleByMultiPort" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="0.329">
    <system-out><![CDATA[2025-04-22 23:31:20.898 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="172.16.0.99" port port="6666" protocol="udp" accept' --permanent
2025-04-22 23:31:21.059 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="172.16.0.99" port port="5555" protocol="udp" accept' --permanent
true
]]></system-out>
  </testcase>
  <testcase name="queryPortRulesByPolicyAndUsingStatus" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="1.86">
    <system-out><![CDATA[2025-04-22 23:31:21.227 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.f.op.FirewallPolicyConfigurer&amp#27;[0;39m - 当前用户: hedeoer
2025-04-22 23:31:21.510 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从富规则中提取的端口规则有portRulesFromRichRules 3 条 :
2025-04-22 23:31:21.510 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从dbus端口查询中提取的端口规则有portRulesFromDbusPortQuery 4 条 :
2025-04-22 23:31:23.087 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,按照（端口号，端口协议）去重，优先富规则形式，合并端口规则后有 6 条 :
2025-04-22 23:31:23.087 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 按照过滤条件：isUsing:null ,policy:null 过滤，都为null，将返回所有的端口规则
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=true, protocol='tcp', port='22', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=true, protocol='tcp', port='6379', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='5953', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='8080', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.22), policy=true, using=false, protocol='tcp', port='30001', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.11), policy=true, using=false, protocol='udp', port='30001', family='ipv4'}
]]></system-out>
  </testcase>
  <testcase name="addOrRemovePortRuleByMultiProtocol" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="0.327">
    <system-out><![CDATA[2025-04-22 23:31:23.088 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="10.0.0.0/8" port port="5555" protocol="tcp" accept' --permanent
2025-04-22 23:31:23.241 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="10.0.0.0/8" port port="5555" protocol="udp" accept' --permanent
true
]]></system-out>
  </testcase>
  <testcase name="queryAllPortRule" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="3.196">
    <system-out><![CDATA[2025-04-22 23:31:23.414 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.f.op.FirewallPolicyConfigurer&amp#27;[0;39m - 当前用户: hedeoer
2025-04-22 23:31:23.682 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从富规则中提取的端口规则有portRulesFromRichRules 3 条 :
2025-04-22 23:31:23.683 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从dbus端口查询中提取的端口规则有portRulesFromDbusPortQuery 4 条 :
2025-04-22 23:31:26.611 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,按照（端口号，端口协议）去重，优先富规则形式，合并端口规则后有 6 条 :
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=true, protocol='tcp', port='22', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=true, protocol='tcp', port='6379', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='5953', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='8080', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.22), policy=true, using=false, protocol='tcp', port='30001', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.11), policy=true, using=false, protocol='udp', port='30001', family='ipv4'}
]]></system-out>
  </testcase>
  <testcase name="testAddOrRemovePortRuleByMultiPortAndMultiProtocol" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="0.629">
    <system-out><![CDATA[2025-04-22 23:31:26.611 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="182.16.0.99" port port="6666" protocol="udp" reject' --permanent
2025-04-22 23:31:26.766 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="182.16.0.99" port port="5555" protocol="udp" reject' --permanent
2025-04-22 23:31:26.936 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="182.16.0.99" port port="6666" protocol="tcp" reject' --permanent
2025-04-22 23:31:27.089 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --remove-rich-rule='rule family="ipv4" source address="182.16.0.99" port port="5555" protocol="tcp" reject' --permanent
true
]]></system-out>
  </testcase>
  <testcase name="addOrRemovePortRule" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="0.324">
    <system-out><![CDATA[2025-04-22 23:31:27.241 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - will execute firewall command : firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="172.16.0.0/24" port port="30001" protocol="tcp" accept' --permanent ; firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="172.16.10.11" port port="30001" protocol="tcp" accept' --permanent
true
]]></system-out>
  </testcase>
  <testcase name="queryPortRulesByPolicy" classname="cn.hedeoer.firewalld.op.PortRuleServiceImplTest" time="2.769">
    <system-out><![CDATA[2025-04-22 23:31:27.565 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.f.op.FirewallPolicyConfigurer&amp#27;[0;39m - 当前用户: hedeoer
2025-04-22 23:31:27.848 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从富规则中提取的端口规则有portRulesFromRichRules 3 条 :
2025-04-22 23:31:27.849 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,从dbus端口查询中提取的端口规则有portRulesFromDbusPortQuery 4 条 :
2025-04-22 23:31:30.334 [main] &amp#27;[34mINFO &amp#27;[0;39m &amp#27;[36mc.h.firewalld.op.PortRuleServiceImpl&amp#27;[0;39m - 当前zone: public,按照（端口号，端口协议）去重，优先富规则形式，合并端口规则后有 6 条 :
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=true, protocol='tcp', port='22', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=true, protocol='tcp', port='6379', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='5953', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=All IPs allowed), policy=true, using=false, protocol='tcp', port='8080', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.22), policy=true, using=false, protocol='tcp', port='30001', family='ipv4'}
PortRule{permanent=true, type=PORT, zone='public', descriptor='All IPs allowed', sourceRule=SourceRule(source=172.16.10.11), policy=true, using=false, protocol='udp', port='30001', family='ipv4'}
]]></system-out>
  </testcase>
</testsuite>